var Phelem={};Phelem.VERSION="0.0.1",Phelem.DEBUG=!0,Phelem.event={},Phelem.event.ready={},Phelem.event.ready.listeners=[],Phelem.event.ready.register=function(a){Phelem.event.ready.listeners.push(a)},Phelem.event.ready.trigger=function(){Phelem.pre.prepare(),Phelem.event.ready.listeners.forEach(function(a){a()})},Phelem.event.scroll={},Phelem.event.scroll.listeners=[],Phelem.event.scroll.register=function(a){Phelem.event.scroll.listeners.push(a)},Phelem.event.scroll.trigger=function(){var a=(window.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0),b=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0);if(void 0==Phelem.event.scroll.oldX||void 0==Phelem.event.scroll.oldY)return Phelem.event.scroll.oldX=a,void(Phelem.event.scroll.oldY=b);var c=Phelem.event.scroll.oldX-a,d=Phelem.event.scroll.oldY-b;Phelem.event.scroll.oldX=a,Phelem.event.scroll.oldY=b;var e=new Phelem.vector.Vector(c/10,d/10);Phelem.event.scroll.listeners.forEach(function(a){a.applyForce(e)}),Phelem.DEBUG&&console.log("Phelem.event.scroll.trigger()","deltaX:",c,", deltaY",d)},Phelem.event.mouse={},Phelem.event.mouse.listeners=[],Phelem.event.mouse.register=function(a){a.element.addEventListener("mouseover",function(b){a.origX=b.clientX,a.origY=b.clientY}),a.element.addEventListener("mouseout",function(b){Phelem.event.mouse.trigger(a,b)})},Phelem.event.mouse.trigger=function(a,b){var c=b.clientX-a.origX,d=b.clientY-a.origY;console.log("Phelem.event.mouse.trigger()","deltaX",c,", deltaY",d);var e=new Phelem.vector.Vector(c/10,d/10);a.applyForce(e),a.origX=void 0,a.origY=void 0},Phelem.event.key={},Phelem.event.key.block=!1,Phelem.event.key.register=function(a){a.element.addEventListener("keydown",function(b){Phelem.event.key.block||(Phelem.event.key.trigger(a),Phelem.event.key.block=!0)}),a.element.addEventListener("keyup",function(a){Phelem.event.key.block=!1})},Phelem.event.key.trigger=function(a){var b=new Phelem.vector.Vector(0,10);a.applyForce(b)},Phelem.event.drag={},Phelem.event.drag.listeners=[],Phelem.event.drag.register=function(a){a.element.addEventListener("dragstart",function(b){var c=document.createElement("img");b.dataTransfer.setDragImage(c,0,0),a.simulation=!1}),a.element.addEventListener("drag",function(b){Phelem.event.drag.trigger(a,b)}),a.element.addEventListener("dragend",function(b){Phelem.event.drag.lastX=void 0,Phelem.event.drag.lastY=void 0,a.velocity.set(0,0),a.acceleration.set(0,0),a.simulation=!0})},Phelem.event.drag.trigger=function(a,b){b=b||window.event;var c=b.clientX,d=b.clientY;if(void 0==Phelem.event.drag.lastX)return Phelem.event.drag.lastX=c,void(Phelem.event.drag.lastY=d);if(0!=c||0!=d){var e=c-Phelem.event.drag.lastX,f=d-Phelem.event.drag.lastY;Phelem.DEBUG&&console.log("Phelem.event.drag.trigger()","deltaX:",e,", deltaY",f),a.position.set(e,f)}},document.addEventListener("DOMContentLoaded",Phelem.event.ready.trigger),window.addEventListener("scroll",Phelem.event.scroll.trigger),Phelem.object={},Phelem.object.objects=[],Phelem.object.Object=function(){this.position=new Phelem.vector.Vector,this.mass=1,this.friction=.9,this.velocity=new Phelem.vector.Vector,this.acceleration=new Phelem.vector.Vector,this.element=null,this.force=new Phelem.vector.Vector,this.simulation=!0},Phelem.object.Object.prototype.registerEvents=function(a){-1!=a.indexOf("scroll")&&Phelem.event.scroll.register(this),-1!=a.indexOf("mouse")&&Phelem.event.mouse.register(this),-1!=a.indexOf("key")&&Phelem.event.key.register(this),-1!=a.indexOf("drag")&&(this.element.draggable=!0,Phelem.event.drag.register(this))},Phelem.object.Object.prototype.setMass=function(a){this.mass=a||1},Phelem.object.Object.prototype.setFriction=function(a){this.friction=a||1},Phelem.object.Object.prototype.applyForce=function(a){this.force.add(a)},Phelem.object.Object.prototype.simulate=function(){if(this.simulation&&!(Math.abs(this.position.x)<1&&Math.abs(this.position.y)<1&&Math.abs(this.velocity.x)<1&&Math.abs(this.velocity.y)<1&&Math.abs(this.acceleration.x)<1&&Math.abs(this.acceleration.x)<1&&Math.abs(this.force.x)<1&&Math.abs(this.force.y)<1)){var a=Phelem.vector.subtract(Phelem.vector.ZERO,this.position);a.multiply(.1),this.velocity.add(a),this.velocity.scale(this.friction),this.velocity.add(this.acceleration),this.velocity.add(a),this.velocity.add(Phelem.vector.divide(this.force,this.mass)),this.force.scale(.5*this.friction),this.position.add(this.velocity),Math.abs(this.force.x)<1&&Math.abs(this.force.y)<1&&this.force.set(0,0),Math.abs(this.acceleration.x)<1&&Math.abs(this.acceleration.y)<1&&this.acceleration.set(0,0),Math.abs(this.velocity.x)<1&&Math.abs(this.velocity.y)<1&&this.velocity.set(0,0),Math.abs(this.position.x)<1&&Math.abs(this.position.y)<1&&this.position.set(0,0),console.log("Phelem.object.Object.simulate()","position",this.position.x,this.position.y,"velocity",this.velocity.x,this.velocity.y,"acceleration",this.acceleration.x,this.acceleration.y)}},Phelem.object.Object.prototype.render=function(){this.simulate(),this.element.style.left=this.position.x+"px",this.element.style.top=this.position.y+"px"},Phelem.pre={},Phelem.pre.prepare=function(){var a=Array.prototype.slice.call(document.getElementsByTagName("*")),b=[];a.forEach(function(a){a.dataset.phelem&&b.push(a)}),Phelem.DEBUG&&console.log("Phelem.pre.prepare()","nodes found","("+b.length+")",b),b.forEach(function(a){var b=new Phelem.object.Object;b.element=a,""==b.element.style.position&&(b.element.style.position="relative"),a.dataset.phelemMass&&b.setMass(Number.parseFloat(a.dataset.phelemMass)),a.dataset.phelemFriction&&b.setFriction(Number.parseFloat(a.dataset.phelemFriction)),a.dataset.phelemEvents&&b.registerEvents(a.dataset.phelemEvents.split(",")),Phelem.object.objects.push(b)})},Phelem.renderer={},Phelem.renderer.init=function(){Phelem.DEBUG&&console.log("Phelem.renderer.init()","initializing renderer now"),Phelem.renderer.render()},Phelem.renderer.render=function(){Phelem.utils.requestAnimationFrame(Phelem.renderer.render),Phelem.object.objects.forEach(function(a){a.render()})},Phelem.event.ready.register(Phelem.renderer.init),Phelem.utils={},Phelem.utils.round=function(a,b){return Math.round(a*b)/b},Phelem.utils.requestAnimationFrame=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}).bind(window),Phelem.vector={},Phelem.vector.Vector=function(a,b){this.set(a,b),this.angle,this.magnitude},Phelem.vector.Vector.prototype.set=function(a,b){this.x=a?a:0,this.y=b?b:0},Phelem.vector.Vector.prototype.add=function(a){this.x+=a.x,this.y+=a.y},Phelem.vector.Vector.prototype.subtract=function(a){this.x-=a.x,this.y-=a.y},Phelem.vector.Vector.prototype.scale=Phelem.vector.Vector.prototype.multiply=function(a){this.x*=a,this.y*=a},Phelem.vector.Vector.prototype.divide=function(a){0==a?(this.x=0,this.y=0):(this.x/=a,this.y/=a)},Phelem.vector.copy=function(a){return new Phelem.vector.Vector(a.x,a.y)},Phelem.vector.add=function(a,b){return new Phelem.vector.Vector(a.x+b.x,a.y+b.y)},Phelem.vector.subtract=function(a,b){return new Phelem.vector.Vector(a.x-b.x,a.y-b.y)},Phelem.vector.scale=Phelem.vector.multiply=function(a,b){return new Phelem.vector.Vector(a.x*b,a.y*b)},Phelem.vector.divide=function(a,b){return 0==b?new Phelem.vector.Vector:new Phelem.vector.Vector(a.x/b,a.y/b)},Phelem.vector.ZERO=new Phelem.vector.Vector(0,0),Phelem.vector.GRAVITY=new Phelem.vector.Vector(0,.00981);